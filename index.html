<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WhatsApp Name & Number Extractor</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; padding: 0; }
    .container { max-width: 900px; margin: 30px auto; background: #fff; padding: 20px; border-radius: 8px; }
    h1 { margin-top: 0; }
    textarea { width: 100%; height: 150px; padding: 10px; margin-top: 10px; border-radius: 4px; border: 1px solid #ccc; }
    button { margin-top: 10px; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; }
    .btn-primary { background: #28a745; color: white; }
    .btn-secondary { background: #007bff; color: white; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    table, th, td { border: 1px solid #ccc; }
    th, td { padding: 8px; text-align: left; }
  </style>
</head>
<body>
  <div class="container">
    <h1>WhatsApp Name & Number Extractor</h1>
    <p>Paste your exported chat or participant list below:</p>
    <textarea id="pasteArea" placeholder="Paste exported chat or participant list here..."></textarea>
    <br>
    <button class="btn-primary" onclick="extractData()">Extract Data</button>
    <button class="btn-secondary" onclick="downloadCSV()">Download CSV</button>
    <table id="resultsTable">
      <thead>
        <tr><th>S.No</th><th>Name</th><th>Number</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
  <script>
    function normalizeNumber(raw) {
      raw = raw.trim();
      const hasPlus = raw.startsWith('+');
      const digits = raw.replace(/[^0-9]/g, '');
      if (!digits) return null;
      let normalized = (hasPlus ? '+' : '') + digits;
      if (digits.length < 10 || digits.length > 15) return null;
      return normalized;
    }function extractData() {
  const text = document.getElementById('pasteArea').value;
  const lines = text.split(/\n/);
  const results = [];
  const seen = new Set();

  lines.forEach(line => {
    // Try WhatsApp chat format: "date - name: message"
    const match = line.match(/^[^\-]+ - ([^:]+):/);
    if (match) {
      let namePart = match[1].trim();
      let numberPart = normalizeNumber(namePart);
      let name = numberPart ? '' : namePart;
      let number = numberPart || '';
      if (!number && /\+?\d[\d\s\-()]{8,20}\d/.test(line)) {
        const numMatch = line.match(/\+?\d[\d\s\-()]{8,20}\d/);
        if (numMatch) number = normalizeNumber(numMatch[0]) || '';
      }
      const key = name + '|' + number;
      if (!seen.has(key) && (name || number)) {
        seen.add(key);
        results.push({ name, number });
      }
    } else {
      // Try participant list style: Name – Number
      const parts = line.split(/[-–]/);
      if (parts.length >= 2) {
        const namePart = parts[0].trim();
        const numCandidate = normalizeNumber(parts[1]);
        if (numCandidate) {
          const key = namePart + '|' + numCandidate;
          if (!seen.has(key)) {
            seen.add(key);
            results.push({ name: namePart, number: numCandidate });
          }
        }
      }
    }
  });

  const tbody = document.querySelector('#resultsTable tbody');
  tbody.innerHTML = '';
  results.forEach((r, i) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${i+1}</td><td>${r.name}</td><td>${r.number}</td>`;
    tbody.appendChild(tr);
  });

  window.extractedResults = results;
}

function downloadCSV() {
  if (!window.extractedResults || !window.extractedResults.length) {
    alert('No data to download.');
    return;
  }
  let csv = 'S.No,Name,Number\n';
  window.extractedResults.forEach((r, i) => {
    csv += `${i+1},"${r.name}","${r.number}"\n`;
  });
  const blob = new Blob([csv], { type: 'text/csv' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'whatsapp_names_numbers.csv';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}

  </script>
</body>
</html>
